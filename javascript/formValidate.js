function f_isValidEmail(v,c){if(v!=null&&v!=""){var x=/^(.+)@(.+)$/;var p='\\(\\)<>@,;:\\\\\\"\\.\\[\\]';var a="\\(\\)<>@,;:\\\\\\\"\\.\\[\\]\\'";var e="[^\\s"+p+"]";var s="[^\\s"+a+"]";var g='("[^"]*")';var w=/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/;var b=e+"+";var k=s+"+";var f="("+b+"|"+g+")";var r=new RegExp("^\\.*"+f+"(\\.*"+f+")*\\.*$");var j=new RegExp("^"+k+"(\\."+k+")*$");var d=v.match(x);if(d==null){callAlertWithField("The format of the email address you entered is not valid for email addresses.",c);return false}var y=d[1];var z=d[2];if(y.match(r)==null){callAlertWithField("Email username doesn't seem to be valid.",c);return false}var o=z.match(w);if(o!=null){for(var t=1;t<=4;t++){if(o[t]>255){callAlertWithField("Email IP address is invalid!",c);return false}}return true}var l=z.match(j);if(l==null){callAlertWithField("Email domain name doesn't seem to be valid.",c);return false}var n=new RegExp(k,"g");var h=z.match(n);var u=h.length;var m=h[h.length-1];if(m.length<2){callAlertWithField("Email address must end in a domain greater than 1 character.",c);return false}if(u<2){var q="Email address is missing a hostname.";callAlertWithField(q,c);return false}}return true}function f_isValidTime(c,d){var a=/^(\d{1,2}):(\d{2})(:(\d{2}))?$/;var b=c.match(a);if(b==null){callAlertWithField("Time is not in a valid format.",d);return(false)}hour=b[1];minute=b[2];second=b[4];if(second==""){second=null}if(hour<0||hour>23){callAlertWithField("Hour must be between 1 and 12. (or 0 and 23 for military time)",d);return(false)}if(minute<0||minute>59){callAlertWithField("Minute must be between 0 and 59.",d);return(false)}if(second!=null&&(second<0||second>59)){callAlertWithField("Second must be between 0 and 59.",d);return(false)}return(true)}function f_isValidText(b,h,a,c,k,g){var l="Only spaces, single quote, and the following characters are allowed: A-Z, a-z, 0-9, # - _ ( ) . ";if(g!=null){l=g}if(c!=null){for(var f=0;f<c.length;f++){l+=c.substring(f,f+1)+" "}}if(h){try{if(h.indexOf("#")>-1){var j=new RegExp("#","gi");if(l.match(j)){l=l.replace(j,"")}}}catch(d){}}for(f=0;f<b.length;f++){var m=b.charAt(f);if(a&&a.indexOf(m)>=0){continue}if(h&&h.indexOf(m)>=0){if(bodyRef.className=="popupDialogBody"){alert("The following characters are not allowed in this field: "+h)}else{callAlertWithField("The following characters are not allowed in this field: "+h,k)}return false}if(((m<"a"||"z"<m)&&(m<"A"||"Z"<m))&&(m<"0"||"9"<m)&&(m!="%20")&&(m!="%23")&&(m!="(")&&(m!=")")&&(m!="-")&&(m!="_")&&(m!="#")&&(m!=" ")&&(m!="'")&&(m!=".")){var e=true;if(c){if(c.indexOf(m)>=0){e=false}}if(e){if(bodyRef.className=="popupDialogBody"){alert(l)}else{callAlertWithField(l,k)}return false}}}return true}function mod(b,a){return Math.round(b-(Math.floor(b/a)*a))}function f_isNumeric(b){var a=b.toString();if(isNaN(b)){callAlert("The number you entered is invalid");return(false)}if(a.indexOf(".")>-1){callAlert("The number you entered is invalid.  Please enter an integer.");return(false)}return(true)}function f_isNumericWithDecimal(b,a){if(isNaN(b)){callAlertWithField("The number you entered is invalid",a);return(false)}return(true)}var dtCh="/";var minYear=1900;var maxYear=2100;function isInteger(b){var a;for(a=0;a<b.length;a++){var d=b.charAt(a);if(((d<"0")||(d>"9"))){return false}}return true}function stripCharsInBag(d,e){var b;var a="";for(b=0;b<d.length;b++){var f=d.charAt(b);if(e.indexOf(f)==-1){a+=f}}return a}function daysInFebruary(a){return(((a%4==0)&&((!(a%100==0))||(a%400==0)))?29:28)}function DaysArray(b){for(var a=1;a<=b;a++){this[a]=31;if(a==4||a==6||a==9||a==11){this[a]=30}if(a==2){this[a]=29}}return this}function f_isValidDate(j,g){if(j.length!=10){callAlertWithField("The date format should be : mm/dd/yyyy",g);return(false)}var a=DaysArray(12);var h=j.indexOf(dtCh);var f=j.indexOf(dtCh,h+1);var e=j.substring(0,h);var b=j.substring(h+1,f);var c=j.substring(f+1);strYr=c;if(b.charAt(0)=="0"&&b.length>1){b=b.substring(1)}if(e.charAt(0)=="0"&&e.length>1){e=e.substring(1)}for(var d=1;d<=3;d++){if(strYr.charAt(0)=="0"&&strYr.length>1){strYr=strYr.substring(1)}}month=parseInt(e);day=parseInt(b);year=parseInt(strYr);if(h==-1||f==-1){callAlertWithField("The date format should be : mm/dd/yyyy",g);return(false)}if(e.length<1||month<1||month>12){callAlertWithField("Please enter a valid month",g);return(false)}if(b.length<1||day<1||day>31||(month==2&&day>daysInFebruary(year))||day>a[month]){callAlertWithField("Please enter a valid day",g);return(false)}if(c.length!=4||year==0||year<minYear||year>maxYear){callAlertWithField("Please enter a valid 4 digit year between "+minYear+" and "+maxYear,g);return(false)}if(j.indexOf(dtCh,f+1)!=-1||isInteger(stripCharsInBag(j,dtCh))==false){callAlertWithField("Please enter a valid date",g);return(false)}return(true)}function f_isValidListName(a,b){if((a=="")||(a==" ")){if(bodyRef.className=="popupDialogBody"){alert("Please enter a name for the "+b+".")}else{callAlert("Please enter a name for the "+b+".")}return false}return f_isValidText(a)}function f_isDateLessThanToday(c){compareToDate=new Date(c);todaysDate=new Date();todaysDate.setHours(0);todaysDate.setMinutes(0);todaysDate.setSeconds(0);targetDate=new Date(todaysDate.getTime());targetDate.setMonth(compareToDate.getMonth());targetDate.setYear(compareToDate.getFullYear());targetDate.setDate(compareToDate.getDate());var a=todaysDate.getTime();var b=targetDate.getTime();if(b<a){return true}else{return false}}function isDateLessThanEqualToDate(c,d){todaysDate=new Date();todaysDate.setHours(0);todaysDate.setMinutes(0);todaysDate.setSeconds(0);date1=new Date(todaysDate);date2=new Date(todaysDate);workDate=new Date(c);date1.setMonth(workDate.getMonth());date1.setYear(workDate.getYear());date1.setDate(workDate.getDate());var b=date1.getTime();workDate=new Date(d);date2.setMonth(workDate.getMonth());date2.setYear(workDate.getYear());date2.setDate(workDate.getDate());var a=date2.getTime();if(b<=a){return true}else{return false}}function f_isDateLessThanDate(c,d){todaysDate=new Date();todaysDate.setHours(0);todaysDate.setMinutes(0);todaysDate.setSeconds(0);date1=new Date(todaysDate);date2=new Date(todaysDate);workDate=new Date(c);date1.setMonth(workDate.getMonth());date1.setYear(workDate.getYear());date1.setDate(workDate.getDate());var b=date1.getTime();workDate=new Date(d);date2.setMonth(workDate.getMonth());date2.setYear(workDate.getYear());date2.setDate(workDate.getDate());var a=date2.getTime();if(b<a){return true}else{return false}}function ValidTime(h,m,s){with(new Date(0,0,0,h,m,s)){return((getHours()==h)&&(getMinutes()==m))}}function convertToMilatary(b){var a;if((a=/^(\d\d):(\d\d)\s?(([ap])\.?m\.?)?$/i.exec(b))==null){return -2}if(a[3]!=""){if(a[1]>"12"){return -1}a[1]=a[1]%12+12*/p/i.test(a[3])}if(!ValidTime(a[1],a[2],0)){return -1}return[+a[1]+":"+a[2]]}function ShowUSTimeVal(a){S=ReadUStime(a);callAlert(S<-1?"Not dd:dd x.m.":S==-1?"Bad value":S)}function f_isDateTimeLessThanTodayDateTime(d,b){compareToDate=new Date(d+" "+convertToMilatary(b));todaysDate=new Date();var a=todaysDate.getTime();var c=compareToDate.getTime();if(c<a){return true}else{return false}}function f_validateForm(k){if(typeof(k)=="undefined"){k="form"}var b=true;var g=false;var c=false;for(var d=0;d<document.forms[k].elements.length;d++){var a=document.forms[k].elements[d];f_useHiddenFieldIfCheckbox(a);var e=a.name+"_REQUIRED";var h=getFormElementByName(k,e);if(a.value==""&&((h&&h.value=="T")||a.getAttribute("required")=="T")){alert("You must fill in all the required fields.");return}if((a.type=="radio"&&a.name=="EMAIL_TYPE")&&((h&&h.value=="T")||a.getAttribute("required")=="T")){c=true;if(a.checked){g=true}}if(a.type=="textarea"){if(a.value.length>4000){alert("Please limit your entries to 4000 characters");return}}var f=a.name+"_DATATYPE";var i=getFormElementByName(k,f);if(i){if(a.value!=""){if(i.value=="time"){b=f_isValidTime(a.value)}if(i.value=="date"){b=f_isValidDate(a.value)}if(i.value=="numeric"){b=f_isNumericWithDecimal(a.value)}if(i.value=="email"){b=f_isValidEmail(a.value)}if(!b){a.focus();return}}}}if(c&&!g){alert("You must fill in all the required fields.");return}document.forms[k].submit()}function f_initializeForm(){if(document.forms[0].tzOffset!=undefined){var c=new Date();var b=Math.floor(c.getTimezoneOffset()/60);document.forms[0].tzOffset.value=b;var d=document.forms[0].sendHourFieldName.value;var e=document.forms[0][d];var a=e.selectedIndex;if(a>1){a-=b;if(a<=1){a+=168}else{if(a>169){a-=168}}e.selectedIndex=a}}}function f_useHiddenFieldIfCheckbox(a){if(a.type=="checkbox"&&a.name.substring(0,7)=="SYSTEM_"){var b=getFormElementByName("form",a.name.substring(7));if(a.checked){b.value="Yes"}else{b.value="No"}}}function callAlert(a){if(typeof spAlert=="undefined"){alert(a)}else{spAlert(a)}}function callAlertWithField(c,b){if(typeof spAlert=="undefined"){alert(c)}else{var a=null;if(b){a=hitch({field:b,ok:function(){this.field.focus();this.field.select()}},"ok")}spAlert(c,null,null,null,null,a)}}function getFormElementByName(d,a){var e=document.getElementsByName(a);var c;for(var b=0;b<e.length;b++){if(e[b].form&&e[b].form.attributes.name.value==d){c=e[b];break}}return c};